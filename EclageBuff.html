<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>埃艾可拉珠時間表產生器(離線版本0.0.0)</title>
</head>
<body onload="init()">
	<div id="panel">
		<div class="row">艾可時間 <input id="st" type="text"></div>
		<div class="row">開機時間 <input id="ft" type="text"></div>
		<div class="row">下次維修 <input id="tt" type="text"></div>
		<div class="row al-r"><button onclick="run()">產生</button></div>
	</div><hr>
	<div>
		<div id="tab"><span class="selected-tab" onclick="show(0)">表格</span><span onclick="show(1)">圖片</span><span onclick="show(2)">編碼</span></div>
	</div>
	<div id="display">
		<div id="preview"></div>
		<div id="imgview" style="display:none"></div>
		<div id="baha" style="display:none"></div>
	</div>
	<style type="text/css">
		#panel{display:inline-block}.al-r{text-align:right}.row{margin:5px;display:inline-block}table{border-collapse:collapse;margin:2px}table,tr,td,th{border:1px solid #000}td,th{text-align:center;font-size:16px;padding:3px 5px;font-family:"Arial","PMingLiU";height:20px}th{height:22px;padding:2px 5px}td{width:42px}#tab{display:inline-block}#tab span{background-color:#fff;border:.5px solid #87ceeb;margin:2px;padding:1px 2px;cursor:default;font-family:"Microsoft JhengHei";font-size:14px;display:inline-block}#tab span.selected-tab{background-color:#add8e6;display:inline-block}
	</style>
	<script type="text/javascript">var st,ft,tt,preview,baha;function run(){function c(a){var d;a=a.split(" ");a[0]=a[0].split("/");a[1]=a[1].split(":");a=a[0].concat(a[1]);for(d=0;d<a.length;++d)a[d]=parseInt(a[d]);console.log(a);return(new Date(a[0],a[1]-1,a[2],a[3],a[4],0,0)).getTime()}refreshData(c(st.value),c(ft.value),c(tt.value))}
function show(c){var a=document.getElementById("display").children,d=document.getElementById("tab").children,h;for(h=0;h<a.length;++h)h==c?(a[h].removeAttribute("style"),d[h].setAttribute("class","selected-tab")):(d[h].removeAttribute("class"),a[h].setAttribute("style","display:none"))}
function refreshData(c,a,d){preview.innerHTML="";baha.innerHTML="";var h=new Date;var g=[];var f=h.getTimezoneOffset();c=c/6E4|0;d=d/6E4|0;c-=110*((c-(a/6E4|0))/110|0);for(a=-1;c<d;c+=110){var b=(c-f)/1440|0;b!=a&&(g.push([]),a=b);g[g.length-1].push(c)}d=function(a){function d(a){a=new Date(6E4*a);return("0"+a.getHours()).substr(-2)+":"+("0"+a.getMinutes()).substr(-2)}var b=0,p=a.length,e,f=[[],[]];var k="\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("");var g=new Date,c=(a[0][0]-g.getTimezoneOffset())%
1440/110|0;b=c+a[0].length;for(e=1;e<a.length;++e)b<a[e].length&&(b=a[e].length);for(e=0;e<a.length;++e)g.setTime(6E4*a[e][0]),f[0].push(),f[0].push("\u661f\u671f"+k[g.getDay()]),f[1].push(),f[1].push(g.getMonth()+1+"\u6708"+g.getDate()+"\u65e5");for(e=0;e<b;++e)for(f.push([0<=e-c&&e-c<a[0].length?d(a[0][e-c]):"",0<=e-c&&e-c<a[0].length?d(a[0][e-c]+10):""]),k=1;k<p;++k)f[e+2].push(e<a[k].length?d(a[k][e]):""),f[e+2].push(e<a[k].length?d(a[k][e]+10):"");return f}(g);var n,l;preview.appendChild(b=document.createElement("table"));
for(f=0;2>f;++f)for(b.appendChild(n=document.createElement("tr")),a=0;a<d[f].length;++a)n.appendChild(l=document.createElement("th")),l.setAttribute("colspan","2"),0==f?l.setAttribute("style","color:#0000DD"):l.setAttribute("style","color:#339966"),l.appendChild(document.createTextNode(d[f][a]));h.setTime(6E4*g[0][0]);for(c=h.getDay();f<d.length;++f)for(b.appendChild(n=document.createElement("tr")),a=0;a<d[f].length;++a)n.appendChild(l=document.createElement("td")),l.appendChild(document.createTextNode(d[f][a])),
l.setAttribute("style","background-color:"+bg_color[(c+(a/2|0))%7]);preview.appendChild(b=document.createElement("p"));b.appendChild(document.createTextNode("\u53ef\u8907\u88fd\u8cbc\u5230\u8a66\u7b97\u8868"));b="[table cellspacing=0 cellpadding=3 border=1][tr]";for(a=0;a<d[0].length;++a)b+="[td colspan=2 align=center][b][color=#0000DD]"+d[0][a]+"[/color][/b][/td]";b+="[/tr][tr]";for(a=0;a<d[0].length;++a)b+="[td colspan=2 align=center][b][color=#339966]"+d[1][a]+"[/color][/b][/td]";b+="[/tr]";h.setTime(6E4*
g[0][0]);c=h.getDay();for(f=2;f<d.length;++f){b+="[tr]";for(a=0;a<d[f].length;++a)b+="[td align=center bgcolor="+bg_color[(c+(a/2|0))%7]+"]"+d[f][a]+"[/td]";b+="[/tr]"}baha.innerHTML="<textarea cols='80' rows='20'>"+(b+"[/table]")+'</textarea><p>\u53ef\u8cbc\u5230\u5df4\u54c8\u59c6\u7279"\u539f\u59cb\u78bc"</p>';(function(a,d){var f=document.getElementById("imgview"),b,e,g;f.innerHTML="";f.appendChild(b=document.createElement("canvas"));b.width=e=1+106*a[0].length;b.height=g=1+27*a.length;b=b.getContext("2d");
b.lineWidth=1;var c;b.fillStyle="#FFFFFF";b.fillRect(.5,0,e,54);for(c=0;c<=e;c+=106)b.fillStyle=bg_color[((c/106|0)+d)%7],b.fillRect(c+.5,54.5,106,g-54);b.beginPath();for(c=0;c<=e;c+=53)b.moveTo(c+.5,(c/53|0)&1?54.5:0),b.lineTo(c+.5,g);for(c=0;c<=g;c+=27)b.moveTo(0,c+.5),b.lineTo(e,c+.5);b.stroke();b.fillStyle="#000000";b.textAlign="center";b.textBaseline="middle";b.font="bold 16px Arial,PMingLiU";b.fillStyle="#0000DD";for(e=0;e<a[0].length;++e)b.fillText(a[0][e],106*e+54,14);b.fillStyle="#339966";
for(e=0;e<a[1].length;++e)b.fillText(a[1][e],106*e+54,41);b.fillStyle="#000000";b.font="16px Arial,PMingLiU";for(c=2;c<a.length;++c)for(e=0;e<a[c].length;++e)b.fillText(a[c][e],53*e+27,27*c+14);f.appendChild(b=document.createElement("p"));b.appendChild(document.createTextNode("\u53ef\u4ee5\u53f3\u9375>\u53e6\u5b58\u5716\u7247"))})(d,c)}var bg_color;
function init(){function c(a){return[a.getFullYear(),a.getMonth()+1,a.getDate()].join("/")+" "+("0"+a.getHours()).substr(-2)+":"+("0"+a.getMinutes()).substr(-2)}function a(a,c,b){function d(a,b,c){return"#"+("0"+a.toString(16)).substr(-2)+("0"+b.toString(16)).substr(-2)+("0"+c.toString(16)).substr(-2)}a%=360;var f=a/60|0,h=a/60-f;a=b*(1-c)*256|0;var g=b*(1-h*c)*256|0;c=b*(1-(1-h)*c)*256|0;b=256*b|0;a=255<a?255:a;g=255<g?255:g;c=255<c?255:c;b=255<b?255:b;switch(f){case 0:var m=d(b,c,a);break;case 1:m=
d(g,b,a);break;case 2:m=d(a,b,c);break;case 3:m=d(a,g,b);break;case 4:m=d(c,a,b);break;case 5:m=d(b,a,g)}return m}st=document.getElementById("st");ft=document.getElementById("ft");tt=document.getElementById("tt");preview=document.getElementById("preview");baha=document.getElementById("baha");var d=new Date;st.value=c(d);var h=(d.getDay()+5)%7;0==h&&720>60*d.getHours()+d.getMinutes()&&(h=7);d.setDate(d.getDate()-h);d.setHours(16);d.setMinutes(0);ft.value=c(d);d.setDate(d.getDate()+7);d.setHours(9);
tt.value=c(d);bg_color=[];for(d=0;7>d;++d)bg_color.push(a(60+360/7*(2*d+1),.3,1))};</script>
</body>
</html>
